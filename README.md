# Scripts used in Durand et al, 2023

The repo contains all scripts used in the study Durand et al (2023). Raw data are provided (except pictures taken by the S & P robot) so that virtually all analyses and graphs can theoretically be reproduced.

## S & P analyses

Pictures taken by the S & P robot are not provided (too many heavy files). Below, we do provide the script used to process them and obtain the provided csv files.

1. Pictures were cropped and converted into inverted levels of gray

```
def get_modified_image(image, outp, pic_fname, xoff=500, yoff=300):
    
    from pathlib import Path
    import os, os.path
    from skimage import io,util
   
    # xoff/yoff = number of pixels that will be cropped from the picture
    
    # Output folder is created only if it doesn't already exist
    Path(outp).mkdir(parents=True, exist_ok=True)
    
    # Picture is cropped
    ## I've added +80 because the plate is not perfectly centered, which means there's more to crop on the left than on the right
    y1,y2,x1,x2=yoff,image.shape[0]-yoff,xoff,image.shape[1]-xoff+80
    cropped = image[y1:y2,x1:x2]

    # Picture is converted into levels of gray
    from skimage.color import rgb2gray
    grayscale = rgb2gray(cropped)
    
    # Levels of gray are inverted: gray on white background equals growth
    grayscale=util.invert(grayscale)
    out=util.img_as_ubyte(grayscale)

    # Converted picture is saved
    io.imsave(outp+pic_fname, out)
    
    return out, outp+pic_fname

# Batch conversion
for f in os.listdir(p):
    fname = os.path.basename(f)
    image = io.imread(p+fname)
    get_modified_image(image, outp, pic_fname = fname)
```
2. Pictures were analyzed using pyphe-quantify
```
# --grid needs to be adapted depending on the size of the array (384, 1536)
# Command line is launched from the folder containing pictures to be analyzed
pyphe-quantify batch --grid auto_384 --pattern "*.JPG" --s 0.1
```
3. CSV files generated by pyphe-quantify were analyzed using [this notebook](robotpics_analysis_manuscript_edition.ipynb)

## Analyses of growth assays in plate readers
- [Growth of FUR1 mutants](20230324_growthcurves_FUR1.ipynb)
- [Growth of mutants in liquid medium](growth_curves_TECAN384.ipynb)
- [Medium conditioning assay](20230331_medium_conditioning.ipynb)
- [Growth of LL13-040 strain in defined media](20230401_growthcurves_SC-SD.ipynb)
- [5-FC dose-response](20230331_dose-response.ipynb)
- [Growth in minimal medium with varying nitrogen sources](20230411_growthcurves_cytosine.ipynb)

## Analyses of cytometry data

- [Rhodamine accumulation assay](rhodamine.ipynb)
- [Fluorescence reporter assay](cytometry-FCY1.ipynb)

## Analyses of WGS data
- [Snakemake pipeline to analyze demultiplexed fastq files](Snakefile)
- [Mutations detected by samtools/gatk/Sanger](FUR1_variants_v2.ipynb)
- [Coverage](coverage.ipynb)